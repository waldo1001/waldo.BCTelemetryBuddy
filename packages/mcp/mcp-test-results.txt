
> bc-telemetry-buddy-mcp@1.0.0 test
> jest

PASS src/__tests__/kusto.test.ts (5.486 s)
PASS src/__tests__/sanitize.test.ts (5.674 s)
PASS src/__tests__/customer-folders.test.ts (5.794 s)
PASS src/__tests__/event-field-samples.test.ts (6.078 s)
PASS src/__tests__/queries.test.ts (6.18 s)
PASS src/__tests__/tenant-mapping.test.ts (6.193 s)
PASS src/__tests__/cache.test.ts (6.255 s)
PASS src/__tests__/auth.test.ts (6.351 s)
PASS src/__tests__/references.test.ts (6.347 s)
PASS src/__tests__/config.test.ts (6.233 s)
  ΓùÅ Console

    console.error
      
      Γ¥î Configuration Error: BCTB_WORKSPACE_PATH environment variable is required

      67 |
      68 |     if (!workspacePath) {
    > 69 |         console.error('\nΓ¥î Configuration Error: BCTB_WORKSPACE_PATH environment variable is required');
         |                 ^
      70 |         console.error('Set it to your workspace path, e.g.: $env:BCTB_WORKSPACE_PATH="C:\\path\\to\\workspace"');
      71 |         console.error('Or create a .bctb-config.json file - run: bctb-mcp init\n');
      72 |         throw new Error('BCTB_WORKSPACE_PATH environment variable is required');

      at loadConfig (src/config.ts:69:17)
      at src/__tests__/config.test.ts:84:36
      at Object.<anonymous> (node_modules/expect/build/index.js:1824:9)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:2235:93)
      at Object.<anonymous> (src/__tests__/config.test.ts:84:40)

    console.error
      Set it to your workspace path, e.g.: $env:BCTB_WORKSPACE_PATH="C:\path\to\workspace"

      68 |     if (!workspacePath) {
      69 |         console.error('\nΓ¥î Configuration Error: BCTB_WORKSPACE_PATH environment variable is required');
    > 70 |         console.error('Set it to your workspace path, e.g.: $env:BCTB_WORKSPACE_PATH="C:\\path\\to\\workspace"');
         |                 ^
      71 |         console.error('Or create a .bctb-config.json file - run: bctb-mcp init\n');
      72 |         throw new Error('BCTB_WORKSPACE_PATH environment variable is required');
      73 |     }

      at loadConfig (src/config.ts:70:17)
      at src/__tests__/config.test.ts:84:36
      at Object.<anonymous> (node_modules/expect/build/index.js:1824:9)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:2235:93)
      at Object.<anonymous> (src/__tests__/config.test.ts:84:40)

    console.error
      Or create a .bctb-config.json file - run: bctb-mcp init

      69 |         console.error('\nΓ¥î Configuration Error: BCTB_WORKSPACE_PATH environment variable is required');
      70 |         console.error('Set it to your workspace path, e.g.: $env:BCTB_WORKSPACE_PATH="C:\\path\\to\\workspace"');
    > 71 |         console.error('Or create a .bctb-config.json file - run: bctb-mcp init\n');
         |                 ^
      72 |         throw new Error('BCTB_WORKSPACE_PATH environment variable is required');
      73 |     }
      74 |

      at loadConfig (src/config.ts:71:17)
      at src/__tests__/config.test.ts:84:36
      at Object.<anonymous> (node_modules/expect/build/index.js:1824:9)
      at Object.throwingMatcher [as toThrow] (node_modules/expect/build/index.js:2235:93)
      at Object.<anonymous> (src/__tests__/config.test.ts:84:40)

    console.error
      
      ΓÜá∩╕Å  Configuration Incomplete:

      140 |
      141 |     if (errors.length > 0) {
    > 142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
          |                 ^
      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');

      at validateConfig (src/config.ts:142:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:174:42)

    console.error
         - BCTB_TENANT_ID is required (unless using azure_cli auth flow)

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:174:42)

    console.error
      
      Server will start but queries will fail until configuration is complete.

      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
      143 |         errors.forEach(err => console.error(`   - ${err}`));
    > 144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
          |                 ^
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }
      147 |

      at validateConfig (src/config.ts:144:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:174:42)

    console.error
      Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.

      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
    > 145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
          |                 ^
      146 |     }
      147 |
      148 |     return errors;

      at validateConfig (src/config.ts:145:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:174:42)

    console.error
      
      ΓÜá∩╕Å  Configuration Incomplete:

      140 |
      141 |     if (errors.length > 0) {
    > 142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
          |                 ^
      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');

      at validateConfig (src/config.ts:142:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:198:42)

    console.error
         - BCTB_APP_INSIGHTS_ID is required

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:198:42)

    console.error
      
      Server will start but queries will fail until configuration is complete.

      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
      143 |         errors.forEach(err => console.error(`   - ${err}`));
    > 144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
          |                 ^
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }
      147 |

      at validateConfig (src/config.ts:144:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:198:42)

    console.error
      Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.

      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
    > 145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
          |                 ^
      146 |     }
      147 |
      148 |     return errors;

      at validateConfig (src/config.ts:145:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:198:42)

    console.error
      
      ΓÜá∩╕Å  Configuration Incomplete:

      140 |
      141 |     if (errors.length > 0) {
    > 142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
          |                 ^
      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');

      at validateConfig (src/config.ts:142:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:222:42)

    console.error
         - BCTB_KUSTO_URL is required

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:222:42)

    console.error
      
      Server will start but queries will fail until configuration is complete.

      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
      143 |         errors.forEach(err => console.error(`   - ${err}`));
    > 144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
          |                 ^
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }
      147 |

      at validateConfig (src/config.ts:144:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:222:42)

    console.error
      Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.

      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
    > 145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
          |                 ^
      146 |     }
      147 |
      148 |     return errors;

      at validateConfig (src/config.ts:145:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:222:42)

    console.error
      
      ΓÜá∩╕Å  Configuration Incomplete:

      140 |
      141 |     if (errors.length > 0) {
    > 142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
          |                 ^
      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');

      at validateConfig (src/config.ts:142:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:246:42)

    console.error
         - BCTB_CLIENT_ID is required for client_credentials auth flow

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:246:42)

    console.error
         - BCTB_CLIENT_SECRET is required for client_credentials auth flow

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:246:42)

    console.error
      
      Server will start but queries will fail until configuration is complete.

      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
      143 |         errors.forEach(err => console.error(`   - ${err}`));
    > 144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
          |                 ^
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }
      147 |

      at validateConfig (src/config.ts:144:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:246:42)

    console.error
      Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.

      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
    > 145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
          |                 ^
      146 |     }
      147 |
      148 |     return errors;

      at validateConfig (src/config.ts:145:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:246:42)

    console.error
      
      ΓÜá∩╕Å  Configuration Incomplete:

      140 |
      141 |     if (errors.length > 0) {
    > 142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
          |                 ^
      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');

      at validateConfig (src/config.ts:142:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:271:42)

    console.error
         - BCTB_CLIENT_SECRET is required for client_credentials auth flow

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:271:42)

    console.error
      
      Server will start but queries will fail until configuration is complete.

      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
      143 |         errors.forEach(err => console.error(`   - ${err}`));
    > 144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
          |                 ^
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }
      147 |

      at validateConfig (src/config.ts:144:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:271:42)

    console.error
      Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.

      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
    > 145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
          |                 ^
      146 |     }
      147 |
      148 |     return errors;

      at validateConfig (src/config.ts:145:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:271:42)

    console.error
      
      ΓÜá∩╕Å  Configuration Incomplete:

      140 |
      141 |     if (errors.length > 0) {
    > 142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
          |                 ^
      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');

      at validateConfig (src/config.ts:142:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:295:42)

    console.error
         - BCTB_TENANT_ID is required (unless using azure_cli auth flow)

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:295:42)

    console.error
         - BCTB_APP_INSIGHTS_ID is required

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:295:42)

    console.error
         - BCTB_KUSTO_URL is required

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:295:42)

    console.error
         - BCTB_CLIENT_ID is required for client_credentials auth flow

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:295:42)

    console.error
         - BCTB_CLIENT_SECRET is required for client_credentials auth flow

      141 |     if (errors.length > 0) {
      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
    > 143 |         errors.forEach(err => console.error(`   - ${err}`));
          |                                       ^
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }

      at src/config.ts:143:39
          at Array.forEach (<anonymous>)
      at validateConfig (src/config.ts:143:16)
      at Object.<anonymous> (src/__tests__/config.test.ts:295:42)

    console.error
      
      Server will start but queries will fail until configuration is complete.

      142 |         console.error('\nΓÜá∩╕Å  Configuration Incomplete:');
      143 |         errors.forEach(err => console.error(`   - ${err}`));
    > 144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
          |                 ^
      145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
      146 |     }
      147 |

      at validateConfig (src/config.ts:144:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:295:42)

    console.error
      Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.

      143 |         errors.forEach(err => console.error(`   - ${err}`));
      144 |         console.error('\nServer will start but queries will fail until configuration is complete.');
    > 145 |         console.error('Run "bctb-mcp init" to create a config file, or "bctb-mcp validate" to check your existing config.\n');
          |                 ^
      146 |     }
      147 |
      148 |     return errors;

      at validateConfig (src/config.ts:145:17)
      at Object.<anonymous> (src/__tests__/config.test.ts:295:42)

FAIL src/__tests__/mcp-standalone.test.ts (6.494 s)
  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Package Structure ΓÇ║ should have standalone MCP package

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      20 |     describe('Phase 2: Package Structure', () => {
      21 |         it('should have standalone MCP package', () => {
    > 22 |             expect(fs.existsSync(mcpPackagePath)).toBe(true);
         |                                                   ^
      23 |
      24 |             const packageJson = require(path.join(mcpPackagePath, 'package.json'));
      25 |             expect(packageJson.name).toBe('bc-telemetry-buddy-mcp');

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:22:51)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Package Structure ΓÇ║ should have compiled server.js and launcher.js

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      27 |
      28 |         it('should have compiled server.js and launcher.js', () => {
    > 29 |             expect(fs.existsSync(mcpServerPath)).toBe(true);
         |                                                  ^
      30 |             expect(fs.existsSync(mcpLauncherPath)).toBe(true);
      31 |         });
      32 |

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:29:50)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Package Structure ΓÇ║ should have @bctb/shared as dependency

    Cannot find module 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\package.json' from 'src/__tests__/mcp-standalone.test.ts'

      44 |
      45 |         it('should have @bctb/shared as dependency', () => {
    > 46 |             const packageJson = require(path.join(mcpPackagePath, 'package.json'));
         |                                 ^
      47 |
      48 |             expect(packageJson.dependencies).toHaveProperty('@bctb/shared');
      49 |         });

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:46:33)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Package Structure ΓÇ║ should have CLI entry point

    Cannot find module 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\package.json' from 'src/__tests__/mcp-standalone.test.ts'

      50 |
      51 |         it('should have CLI entry point', () => {
    > 52 |             const packageJson = require(path.join(mcpPackagePath, 'package.json'));
         |                                 ^
      53 |
      54 |             expect(packageJson.bin).toBeDefined();
      55 |             expect(packageJson.bin['bc-telemetry-mcp']).toBe('./dist/cli.js');

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:52:33)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Service Integration ΓÇ║ should import services from @bctb/shared

    ENOENT: no such file or directory, open 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\dist\server.js'

      59 |     describe('Phase 2: Service Integration', () => {
      60 |         it('should import services from @bctb/shared', () => {
    > 61 |             const serverSource = fs.readFileSync(mcpServerPath, 'utf-8');
         |                                     ^
      62 |
      63 |             // Verify imports from @bctb/shared
      64 |             expect(serverSource).toContain('@bctb/shared');

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:61:37)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Deployment ΓÇ║ should have npm scripts for build and start

    Cannot find module 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\package.json' from 'src/__tests__/mcp-standalone.test.ts'

      82 |     describe('Phase 2: Deployment', () => {
      83 |         it('should have npm scripts for build and start', () => {
    > 84 |             const packageJson = require(path.join(mcpPackagePath, 'package.json'));
         |                                 ^
      85 |
      86 |             expect(packageJson.scripts.build).toBeDefined();
      87 |             expect(packageJson.scripts.start).toBeDefined();

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:84:33)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Deployment ΓÇ║ should build successfully

    spawn C:\WINDOWS\system32\cmd.exe ENOENT


  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Configuration ΓÇ║ should read environment variables for configuration

    ENOENT: no such file or directory, open 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\dist\server.js'

      116 |     describe('Phase 2: Configuration', () => {
      117 |         it('should read environment variables for configuration', () => {
    > 118 |             const serverSource = fs.readFileSync(mcpServerPath, 'utf-8');
          |                                     ^
      119 |
      120 |             // Verify server reads env vars
      121 |             const envVars = [

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:118:37)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Configuration ΓÇ║ should support both HTTP server and stdio modes

    ENOENT: no such file or directory, open 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\dist\server.js'

      133 |
      134 |         it('should support both HTTP server and stdio modes', () => {
    > 135 |             const serverSource = fs.readFileSync(mcpServerPath, 'utf-8');
          |                                     ^
      136 |
      137 |             // Server should support stdio (for MCP protocol)
      138 |             expect(serverSource).toContain('stdio');

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:135:37)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Independence from Extension ΓÇ║ should NOT import anything from extension package

    ENOENT: no such file or directory, open 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\dist\server.js'

      142 |     describe('Phase 2: Independence from Extension', () => {
      143 |         it('should NOT import anything from extension package', () => {
    > 144 |             const serverSource = fs.readFileSync(mcpServerPath, 'utf-8');
          |                                     ^
      145 |
      146 |             // Should NOT reference extension package
      147 |             expect(serverSource).not.toContain('../extension');

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:144:37)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Independence from Extension ΓÇ║ should work with global npm installation

    Cannot find module 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\package.json' from 'src/__tests__/mcp-standalone.test.ts'

      150 |
      151 |         it('should work with global npm installation', () => {
    > 152 |             const packageJson = require(path.join(mcpPackagePath, 'package.json'));
          |                                 ^
      153 |
      154 |             // Should be publishable to npm
      155 |             expect(packageJson.name).toBeDefined();

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:152:33)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: Independence from Extension ΓÇ║ should declare peer dependencies correctly

    Cannot find module 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\package.json' from 'src/__tests__/mcp-standalone.test.ts'

      162 |
      163 |         it('should declare peer dependencies correctly', () => {
    > 164 |             const packageJson = require(path.join(mcpPackagePath, 'package.json'));
          |                                 ^
      165 |
      166 |             // Should list required Azure SDKs
      167 |             expect(packageJson.dependencies).toHaveProperty('@azure/msal-node');

      at Resolver._throwModNotFoundError (node_modules/jest-resolve/build/index.js:863:11)
      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:164:33)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: CLI Functionality ΓÇ║ should have CLI entry point file

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      174 |         it('should have CLI entry point file', () => {
      175 |             const cliPath = path.join(mcpPackagePath, 'dist', 'cli.js');
    > 176 |             expect(fs.existsSync(cliPath)).toBe(true);
          |                                            ^
      177 |         });
      178 |
      179 |         it('should support query-telemetry command', () => {

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:176:44)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: CLI Functionality ΓÇ║ should support query-telemetry command

    ENOENT: no such file or directory, open 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\dist\cli.js'

      178 |
      179 |         it('should support query-telemetry command', () => {
    > 180 |             const cliSource = fs.readFileSync(path.join(mcpPackagePath, 'dist', 'cli.js'), 'utf-8');
          |                                  ^
      181 |
      182 |             expect(cliSource).toContain('query-telemetry');
      183 |         });

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:180:34)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: CLI Functionality ΓÇ║ should support save-query command

    ENOENT: no such file or directory, open 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\dist\cli.js'

      184 |
      185 |         it('should support save-query command', () => {
    > 186 |             const cliSource = fs.readFileSync(path.join(mcpPackagePath, 'dist', 'cli.js'), 'utf-8');
          |                                  ^
      187 |
      188 |             expect(cliSource).toContain('save-query');
      189 |         });

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:186:34)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Phase 2: CLI Functionality ΓÇ║ should support list-queries command

    ENOENT: no such file or directory, open 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\dist\cli.js'

      190 |
      191 |         it('should support list-queries command', () => {
    > 192 |             const cliSource = fs.readFileSync(path.join(mcpPackagePath, 'dist', 'cli.js'), 'utf-8');
          |                                  ^
      193 |
      194 |             expect(cliSource).toContain('list-queries');
      195 |         });

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:192:34)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Error Handling ΓÇ║ should validate configuration on startup

    ENOENT: no such file or directory, open 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\dist\server.js'

      198 |     describe('Error Handling', () => {
      199 |         it('should validate configuration on startup', () => {
    > 200 |             const serverSource = fs.readFileSync(mcpServerPath, 'utf-8');
          |                                     ^
      201 |
      202 |             // Should check for required config
      203 |             expect(serverSource).toContain('tenantId');

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:200:37)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Error Handling ΓÇ║ should handle missing workspace path gracefully

    ENOENT: no such file or directory, open 'C:\_Source\Community\waldo.BCTelemetryBuddy\mcp\dist\launcher.js'

      207 |         it('should handle missing workspace path gracefully', async () => {
      208 |             // Start server without workspace path should fail gracefully
    > 209 |             const launcherSource = fs.readFileSync(mcpLauncherPath, 'utf-8');
          |                                       ^
      210 |
      211 |             expect(launcherSource).toContain('BCTB_WORKSPACE_PATH');
      212 |         });

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:209:39)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Test Coverage for MCP ΓÇ║ should have unit tests for all MCP modules

    expect(received).toBe(expected) // Object.is equality

    Expected: true
    Received: false

      217 |             const testPath = path.join(mcpPackagePath, 'src', '__tests__');
      218 |
    > 219 |             expect(fs.existsSync(testPath)).toBe(true);
          |                                             ^
      220 |
      221 |             const testFiles = fs.readdirSync(testPath);
      222 |             const requiredTests = [

      at Object.<anonymous> (src/__tests__/mcp-standalone.test.ts:219:45)

  ΓùÅ MCP Server Standalone Operation ΓÇ║ Test Coverage for MCP ΓÇ║ should have high test coverage

    spawn C:\WINDOWS\system32\cmd.exe ENOENT


PASS src/__tests__/event-catalog.test.ts (6.341 s)
PASS src/__tests__/azure-cli-auth.test.ts (6.505 s)
PASS src/__tests__/event-lookup.test.ts (7.01 s)

Test Suites: 1 failed, 13 passed, 14 total
Tests:       20 failed, 285 passed, 305 total
Snapshots:   0 total
Time:        8.004 s
Ran all test suites.
